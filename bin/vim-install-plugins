#!/bin/bash

VIM_FOLDER="$HOME/.vim"
PLUGIN_FOLDER="$VIM_FOLDER/bundle"
PLUGIN_FILE="$VIM_FOLDER/PLUGINS.txt"

if [ -e "$VIM_FOLDER/autoload" ] &&
   [ -e "$VIM_FOLDER/autoload/pathogen.vim" ]; then
  echo "Pathogen already installed"
else
  echo "Installing pathogen..."
  mkdir -p "$VIM_FOLDER/autoload"
  curl -LSso "$VIM_FOLDER/autoload/pathogen.vim" https://tpo.pe/pathogen.vim
  echo "Creating PLUGIN folder..."
  mkdir -p "$PLUGIN_FOLDER"
  echo "Done!"
fi

cat $PLUGIN_FILE | while read line
do
  if [ -z "$line" ]; then
    continue
  fi

  if [ -z "$PLUGIN_NAME" ]; then
    PLUGIN_NAME=$line
    continue
  fi

  if [ -z "$PLUGIN_SRC" ]; then
    PLUGIN_SRC=$line
  fi

  if [ -d $PLUGIN_FOLDER/$PLUGIN_NAME ]; then
    echo "$PLUGIN_NAME already installed"
  else
    echo "Installing $PLUGIN_NAME"
    git clone $PLUGIN_SRC "$PLUGIN_FOLDER/$PLUGIN_NAME"
  fi

  unset PLUGIN_SRC
  unset PLUGIN_NAME

done
